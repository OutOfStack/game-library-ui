apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
    name: game-library-ui-ingress
    namespace: game-library
    annotations:
        cert-manager.io/cluster-issuer: letsencrypt
        ingressclass.kubernetes.io/is-default-class: "true"
        nginx.ingress.kubernetes.io/proxy-connect-timeout: "30"
        nginx.ingress.kubernetes.io/proxy-send-timeout: "300"
        nginx.ingress.kubernetes.io/proxy-read-timeout: "300"
spec:
    tls:
      - hosts:
          - _K8S_URL_
        secretName: tls-secret
    rules:
      - host: _K8S_URL_
        http:
            paths:
              - backend:
                    service:
                        name: game-library-ui-service
                        port:
                            number: 80
                path: /
                pathType: Prefix
                
---
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
    name: letsencrypt
spec:
    acme:
        email: _ACME_EMAIL_
        server: https://acme-v02.api.letsencrypt.org/directory
        # Secret resource that will be used to store the account's private key.
        privateKeySecretRef:
            name: lets-encrypt-private-key
        # Add a single challenge solver, HTTP01 using nginx
        solvers:
          - http01:
                ingress:
                    # specific to microk8s
                    class: public
