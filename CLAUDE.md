# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Development Commands

### Essential Commands
- `npm run dev` - Start development server (runs on port 3000)
- `npm run build` - Build for production (outputs to `build/` directory)
- `npm test` - Run tests using Vitest
- `./env.sh` - Generate runtime environment configuration from .env file

### Make Commands (alternative)
- `make run` - Start development server (runs `./env.sh` then `npm run dev`)
- `make build` - Build for production
- `make test` - Run tests

### Important Setup Steps
1. Run `./env.sh` before starting development server to generate `env-config.js` from `.env` file
2. Configure `.env` file with backend service URLs:
   - `GAMES_URL` - Backend games service (default: http://localhost:8000)
   - `AUTH_URL` - Authentication service (default: http://localhost:8001)

## Architecture Overview

### Tech Stack
- **Frontend**: React 19 + TypeScript 5 + Vite 7
- **UI Framework**: Material-UI (MUI) v7 with custom theming
- **Routing**: React Router v7
- **State Management**: React hooks (no external state management library)
- **Testing**: Vitest + Testing Library
- **Styling**: MUI + tss-react for styling
- **Build**: Vite with custom configuration

### Project Structure
```
src/
├── api-clients/        # API endpoint configurations
├── components/         # Reusable UI components
├── hooks/             # Custom React hooks
│   └── request/       # HTTP request utilities
├── types/             # TypeScript type definitions
├── utils/             # Utility functions
└── views/             # Page components
```

### Key Architectural Patterns

#### API Communication
- **Base Request**: All API calls go through `src/hooks/request/baseRequest.ts` which handles error responses and validation
- **Endpoints**: API URLs configured in `src/api-clients/endpoints.ts` using runtime environment variables
- **Custom Hooks**: Service-specific hooks (`useGames`, `useAuth`, `useGenres`, etc.) encapsulate API interactions

#### Authentication
- JWT-based authentication with localStorage persistence
- Token validation with expiration checking
- Role-based access control (admin/user roles)
- Auth state managed through `useAuth` hook

#### Environment Configuration
- Runtime environment configuration via `env-config.js` generated by `./env.sh`
- Environment variables accessed through `(window as any)._env_` global object
- Supports both development and production deployments

#### Theme System
- Material-UI theming with dark/light mode support
- Theme persistence in localStorage
- Custom color palette using Material-UI color system
- Responsive design with `useMediaQuery`

### Component Organization
- **Layout**: Main layout wrapper with header and content area
- **GameCard**: Individual game display component
- **GameDetails**: Detailed game view with modal functionality
- **Header**: Navigation with search and authentication
- **Modal**: Reusable modal component for various use cases

### State Management Approach
- No external state management library (Redux, Zustand, etc.)
- State managed through React hooks and prop drilling
- Authentication state centralized in `useAuth` hook
- Service data managed through custom hooks with internal state

### Testing Configuration
- Vitest with jsdom environment
- Testing Library for component testing
- Global test utilities setup in `src/setupTests.ts`
- Test configuration in `vite.config.ts`

### Deployment
- Docker multi-stage build with Nginx serving static files
- Kubernetes deployment configurations in `deploy/` directory
- GitHub Actions CI/CD pipeline for automated testing and deployment
- Environment variables injected at runtime via `env-config.js`